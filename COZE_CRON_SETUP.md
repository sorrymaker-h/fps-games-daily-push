# Coze Cron 定时任务配置指南

## 🎯 快速开始

Coze Cron 是 Coze 官方提供的云端定时任务服务，完全免费、无需服务器、自动运行。

---

## 📋 配置步骤

### 第1步：登录 Coze 平台

1. **打开 Coze 平台**
   - 国内版：https://www.coze.cn/
   - 国际版：https://www.coze.com/

2. **登录账号**
   - 使用手机号或邮箱登录

---

### 第2步：进入工作流管理

1. **点击左侧菜单的 "工作流"**
2. **找到你的工作流项目**
   - 项目名称：`游戏榜单工作流`
   - 如果找不到，需要先部署

---

### 第3步：部署工作流（如果还没部署）

1. **进入工作流编辑页面**
2. **点击右上角 "部署" 按钮**
3. **选择 "Coze Cloud"**
4. **点击 "确认部署"**
5. **等待部署完成**（约 1-2 分钟）

---

### 第4步：配置定时任务

1. **在部署后的页面，找到 "定时任务" 选项**
2. **点击 "添加定时任务"**
3. **配置定时规则**：

   **方案 A：每天早上 10 点（推荐）**
   - 触发方式：`Cron 表达式`
   - Cron 表达式：`0 10 * * *`
   - 说明：每天 10:00 执行

   **方案 B：每天晚上 10 点**
   - Cron 表达式：`0 22 * * *`
   - 说明：每天 22:00 执行

   **方案 C：自定义时间**
   - 使用 Cron 表达式生成器：https://crontab.guru/
   - 复制生成的表达式

4. **配置环境变量**（如果需要）：

   **钉钉 Webhook URL**
   - 变量名：`DINGTALK_WEBHOOK_URL`
   - 值：`https://oapi.dingtalk.com/robot/send?access_token=5f30c823eb6bf1a6c16fae13f002d068b6b39bc7857e6eb651f3bfc56e8a85f3`

5. **点击 "保存"**

---

### 第5步：启用定时任务

1. **找到刚才创建的定时任务**
2. **点击 "启用" 按钮**
3. **确认状态变为 "运行中"**

---

## ✅ 配置完成！

### 验证方式

#### 方式 1：查看执行记录

1. **进入工作流管理页面**
2. **点击 "执行记录" 标签**
3. **查看定时任务的执行记录**
4. **✅ 显示 "成功" = 配置正确**
5. **❌ 显示 "失败" = 需要检查配置**

#### 方式 2：等待下次执行

- 如果设置的是每天 10 点，等到 10 点后
- 查看钉钉群是否收到消息

#### 方式 3：手动测试

1. **进入工作流编辑页面**
2. **点击 "测试运行" 按钮**
3. **查看执行结果**
4. **检查钉钉群是否收到消息**

---

## 📊 Cron 表达式说明

### 基本格式

```
分钟 小时 日 月 周
*   *   *   *  *
```

### 常用表达式

| 时间 | Cron 表达式 | 说明 |
|------|------------|------|
| 每天 10:00 | `0 10 * * *` | 早上 10 点执行 |
| 每天 08:00 | `0 8 * * *` | 早上 8 点执行 |
| 每天 12:00 | `0 12 * * *` | 中午 12 点执行 |
| 每天 18:00 | `0 18 * * *` | 晚上 6 点执行 |
| 每天 22:00 | `0 22 * * *` | 晚上 10 点执行 |
| 工作日 10:00 | `0 10 * * 1-5` | 周一到周五 10 点 |
| 每小时 | `0 * * * *` | 每小时的 0 分执行 |
| 每 30 分钟 | `*/30 * * * *` | 每 30 分钟执行 |

### 高级用法

- `*/5 * * * *` - 每 5 分钟执行
- `0 9-17 * * 1-5` - 工作日的 9 点到 17 点
- `0 0 1 * *` - 每月 1 号的 0 点执行

---

## 🔧 环境变量配置

### 必需变量

#### DINGTALK_WEBHOOK_URL（钉钉机器人）

- **变量名**：`DINGTALK_WEBHOOK_URL`
- **值**：
  ```
  https://oapi.dingtalk.com/robot/send?access_token=5f30c823eb6bf1a6c16fae13f002d068b6b39bc7857e6eb651f3bfc56e8a85f3
  ```
- **说明**：钉钉机器人 Webhook URL，用于发送消息

---

## ⚠️ 常见问题

### Q1: 定时任务没有执行

**可能原因**：
1. 定时任务未启用
2. Cron 表达式错误
3. 环境变量未配置

**解决方法**：
1. 确认定时任务状态为 "运行中"
2. 检查 Cron 表达式是否正确
3. 确认环境变量已正确配置

---

### Q2: 执行失败

**可能原因**：
1. 网络错误
2. 钉钉机器人配置错误
3. 工作流代码错误

**解决方法**：
1. 查看 "执行记录" 中的详细日志
2. 检查钉钉 Webhook URL 是否正确
3. 在编辑页面手动测试工作流

---

### Q3: 钉钉群没有收到消息

**可能原因**：
1. Webhook URL 错误
2. 钉钉机器人被禁用
3. 钉钉群被解散

**解决方法**：
1. 确认 Webhook URL 完整且正确
2. 检查钉钉群中的机器人是否启用
3. 确认钉钉群是否存在

---

### Q4: 如何修改定时规则

**步骤**：
1. 进入定时任务管理页面
2. 点击定时任务右侧的 "编辑" 按钮
3. 修改 Cron 表达式
4. 保存修改

---

## 📊 监控和管理

### 查看执行记录

1. **进入工作流管理页面**
2. **点击 "执行记录"**
3. **查看所有执行记录**
4. **点击具体记录查看详细日志**

### 查看统计信息

1. **进入定时任务管理页面**
2. **查看定时任务的统计信息**
3. **包括**：执行次数、成功率、失败次数等

---

## 🎉 优势总结

### Coze Cron 的优势

| 特性 | 优势 |
|------|------|
| **完全免费** | Coze 官方提供，无额外费用 |
| **无需服务器** | 云端运行，不需要自己部署 |
| **配置简单** | 简单几步即可完成 |
| **稳定可靠** | Coze 官方维护，稳定性高 |
| **自动执行** | 设置后自动运行，无需人工干预 |
| **监控完善** | 详细的执行记录和日志 |

---

## 📞 技术支持

如果遇到问题：

1. **查看文档**：https://www.coze.cn/docs
2. **联系客服**：Coze 平台内的客服系统
3. **社区支持**：Coze 开发者社区

---

## ✅ 配置清单

完成以下所有项表示配置成功：

- [ ] 登录 Coze 平台
- [ ] 部署工作流到 Coze Cloud
- [ ] 配置定时任务（Cron 表达式）
- [ ] 配置环境变量（DINGTALK_WEBHOOK_URL）
- [ ] 启用定时任务
- [ ] 手动测试成功
- [ ] 查看执行记录

---

## 🚀 开始使用

现在你可以：

1. **配置 Coze Cron 定时任务**
2. **设置每天自动推送 FPS 游戏资讯**
3. **每天早上 10 点自动接收钉钉消息**
4. **完全免费、无需服务器**

---

**祝你使用愉快！** 🎉
